/**
 * 2015-12-08 by hangyangws
 * [Provider 内容管理]
 */

! function($) {
    "use strict";
    var Provider = (function() {
        var $addDom = $('#addDom').html(),
            _operation = true;
        return {
            ini: function() {
                Pj.qiNiu();
                Pj.inputText();
                Pj.inputDate($allWrap.find('.package-form'));
            },
            addDom: function($this) {
                $this.prev().append($addDom);
            },
            copy: function($this) {
                if (confirm('确认复制服务商: ' + $this.data('name'))) {
                    var $d,
                        $t;
                    if (_operation) {
                        _operation = false;
                        $.remaind('操作中，请稍后...', false);
                        $.ajax({
                            type: 'POST',
                            url: global.copyAreaUrl,
                            dataType: 'json',
                            data: {
                                id: $this.data('id')
                            },
                            success: function(r) {
                                if (r.status === 'success') {
                                    $.showMask(false);
                                    $d = $this.clone();
                                    $t = $d.find('.edit-this');
                                    $t.attr('href', $t.attr('href').replace(/\/\d+$/, '/' + r.data.id));
                                    $d.find('.upname').html(r.data.upname).end()
                                        .attr('data-id', r.data.id);
                                    $this.parent().append($d);
                                } else {
                                    $.remaind(r.message, true);
                                };
                                _operation = true;
                            },
                            error: function() {
                                $.remaind('网络堵塞', true);
                                _operation = true;
                            }
                        });
                    };
                };
            }
        };
    })();
    Provider.ini();
    // 板块选择
    $allWrap.on('change', '.category-type', function() {
        // Article.artPagingGo('', $(this).val(), '');
    });
    // 关键字搜索
    $allWrap.on('click', '.service-search-btn', function() {
        // Article.artSearch($.trim($(this).prev().val()));
    });
    // 翻页
    $allWrap.on('click', '.con-paging .art-paging-dir', function() {
        // $(this).is('.disable') || Article.artPagingJudge($(this));
    });
    $allWrap.on('change', '.con-paging .art-paging-sel', function() {
        // Article.artPagingJudge($(this));
    });
    // 节点添加
    $allWrap.on('click', '.provider-add-dom', function() {
        Provider.addDom($(this));
    });
    // 复制
    $allWrap.on('click', '.copy-provider', function() {
        Provider.copy($(this).closest('tr'));
    });
}(jQuery);
